import{j as e,f as U,r,E as f,b as B,L as P}from"./index-Q6dyHrre.js";import{F as Z,a as $,b,c as i,S as Q,B as W}from"./index-zoz3kVfw.js";import{d as G,G as y,e as R,f as q,a as d,g as z}from"./index-Bkeb3vF4.js";import{C as J}from"./CreateTicketModal-CHGt2-BS.js";import{l as K}from"./index-CF4wHI2V.js";const X=({text:t,onClick:u})=>e.jsxs("button",{onClick:u,className:"bg-[rgb(24,161,161)] text-white rounded-xl flex items-center px-10  text-xl py-3",children:[e.jsx(G,{className:"mr-3"}),t]});function Y(t){return y({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,128a95.76,95.76,0,0,1-31.8,71.37A72,72,0,0,0,128,160a40,40,0,1,0-40-40,40,40,0,0,0,40,40,72,72,0,0,0-64.2,39.37h0A96,96,0,1,1,224,128Z",opacity:"0.2"},child:[]},{tag:"path",attr:{d:"M168,56a8,8,0,0,1,8-8h16V32a8,8,0,0,1,16,0V48h16a8,8,0,0,1,0,16H208V80a8,8,0,0,1-16,0V64H176A8,8,0,0,1,168,56Zm62.56,54.68a103.92,103.92,0,1,1-85.24-85.24,8,8,0,0,1-2.64,15.78A88.07,88.07,0,0,0,40,128a87.62,87.62,0,0,0,22.24,58.41A79.66,79.66,0,0,1,98.3,157.66a48,48,0,1,1,59.4,0,79.66,79.66,0,0,1,36.06,28.75A87.62,87.62,0,0,0,216,128a88.85,88.85,0,0,0-1.22-14.68,8,8,0,1,1,15.78-2.64ZM128,152a32,32,0,1,0-32-32A32,32,0,0,0,128,152Zm0,64a87.57,87.57,0,0,0,53.92-18.5,64,64,0,0,0-107.84,0A87.57,87.57,0,0,0,128,216Z"},child:[]}]})(t)}function I(t){return y({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,64H154.67L126.93,43.2a16.12,16.12,0,0,0-9.6-3.2H72A16,16,0,0,0,56,56V72H40A16,16,0,0,0,24,88V200a16,16,0,0,0,16,16H192.89A15.13,15.13,0,0,0,208,200.89V184h16.89A15.13,15.13,0,0,0,240,168.89V80A16,16,0,0,0,224,64Zm0,104H208V112a16,16,0,0,0-16-16H122.67L94.93,75.2a16.12,16.12,0,0,0-9.6-3.2H72V56h45.33L147.2,78.4A8,8,0,0,0,152,80h72Z"},child:[]}]})(t)}const ee=({ticketInfo:t,onClick:u,activeCard:g})=>{const m=g===t.ticket_status;return e.jsxs("div",{className:`shadow-md rounded-xl p-4 w-[195px] h-[100px] mt-4 cursor-pointer hover:bg-[rgb(142,189,189)] ${m?"bg-[rgb(177,216,216)]":"bg-white"}`,onClick:()=>u(t.ticket_status),children:[e.jsx("div",{className:"flex items-center justify-between text-gray-600",children:t.ticket_status}),e.jsxs("div",{className:"flex felx-col items-center justify-between text-2xl font-bold mt-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:t.count}),e.jsxs("div",{className:"flex items-center justify-between",children:[t.ticket_status==="All Tickets"&&e.jsx("div",{className:"bg-purple-200 p-2 rounded-full",children:e.jsx(I,{color:"purple"})}),t.ticket_status==="Open Tickets"&&e.jsx("div",{className:"bg-blue-200 p-2 rounded-full",children:e.jsx(Z,{color:"blue"})}),t.ticket_status==="Working Tickets"&&e.jsx("div",{className:"bg-pink-100 p-2 rounded-full",children:e.jsx($,{color:"pink"})}),t.ticket_status==="Solved Tickets"&&e.jsx("div",{className:"bg-green-100 p-2 rounded-full",children:e.jsx(b,{color:"green"})}),t.ticket_status==="Unassigned Tickets"&&e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(Y,{color:"orange"})}),t.ticket_status==="Overdue Tickets"&&e.jsx("div",{className:"bg-red-100 p-2 rounded-full",children:e.jsx(i,{color:"red"})}),t.ticket_status==="On-Hold Tickets"&&e.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:e.jsx(R,{color:"gray"})}),t.ticket_status==="Needs Verification"&&e.jsx("div",{className:"bg-purple-100 p-2 rounded-full",children:e.jsx(q,{color:"purple"})})]})]})]})},de=()=>{const{getUserCookie:t}=U(),[u,g]=r.useState([]),[m,w]=r.useState([]),[p,T]=r.useState(""),[_,v]=r.useState(!1),[x,C]=r.useState("All Tickets"),{call:S}=f("internal_ticketing.ticketing_api.get_ticket_count_by_department"),{call:A}=f("internal_ticketing.ticketing_api.get_ticket_list"),L=["Cancelled Tickets"],[H,k]=r.useState("All Tickets"),[a,O]=r.useState(""),[c,V]=r.useState(""),[se,te]=r.useState([]),{ticketId:re}=B();d.set(t);const{call:D}=f("internal_ticketing.ticketing_api.get_user_department"),N=K("http://10.80.4.63:9001");N.on("ticket_updated",s=>{console.log("ðŸ”„ Ticket update received from Node:",s),a&&c&&(h(a,c,d.get("user_id")),j(a,c,d.get("user_id")))}),N.on("new_ticket",s=>{console.log("ðŸ”„ New ticket received from Node:",s),a&&c&&(h(a,c,d.get("user_id")),j(a,c,d.get("user_id")))}),r.useEffect(()=>{D({user_id:d.get("user_id")}).then(s=>{O(s.message[0].department),V(s.message[0].user_permission_type),h(a,c,d.get("user_id")),j(a,c,d.get("user_id"))}).catch(s=>{console.log("Error",s)})},[a]);const F=()=>{v(!0)},M=()=>{v(!1)},h=(s,o,n)=>{S({department:s,user_permission_type:o,user_id:n}).then(l=>{g(Object.values(l.message))}).catch(l=>{console.log("Error",l)})},j=(s,o,n)=>{A({department:s,user_permission_type:o,user_id:n}).then(l=>{w(l.message)}).catch(l=>{console.log("Error",l)})},E=s=>{C(s),k(s)};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full flex",children:[e.jsx("div",{className:"w-1/2",children:e.jsx(Q,{searchQuery:p,onSearchQueryChange:T})}),e.jsxs("div",{className:"w-1/2 flex justify-end",children:[e.jsx(X,{text:"Create Ticket",onClick:F}),_&&e.jsx(J,{onClick:M,isOpen:_,isSubticket:!1})]})]}),e.jsx("div",{className:"flex gap-4 flex flex-row w-full flex-wrap",children:u.map((s,o)=>!L.includes(s.ticket_status)&&e.jsx("div",{children:e.jsx(ee,{ticketInfo:s,activeCard:H,onClick:n=>{E(n),k(n)}})},o))}),e.jsxs("div",{className:"p-4 shadow-2xl rounded-lg bg-white mt-3",children:[e.jsx("div",{className:"flex justify-between items-center px-4 my-2",children:e.jsx("h2",{className:"text-xl font-bold",children:x||"All Tickets List"})}),e.jsx("hr",{className:"border-gray-200 mt-4"}),e.jsx("div",{className:"p-2 rounded-lg bg-white cursor-pointer overflow-y-auto max-h-[600px] scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 flex flex-col gap-1 mt-2",children:m.length>0?m.map(s=>(x==="All Tickets"||s.ticket_status===x)&&(p===""||s.subject.toLowerCase().includes(p.toLowerCase()))&&e.jsxs(P,{to:`/dashboard/tickets/${s.name}`,className:"border-2 border-gray-200 p-4 mb-2 rounded hover:bg-[rgb(177,216,216)] flex justify-between items-start rounded-2xl",children:[e.jsxs("div",{className:"flex ",children:[s.status==="Open"&&e.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(i,{color:"red"})}),s.status==="Working"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(b,{color:"green"})}),s.status==="Solved"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(b,{color:"green"})}),s.status==="Sent"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(i,{color:"green"})}),s.status==="Unassigned"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(i,{color:"green"})}),s.status==="Overdue"&&e.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(i,{color:"red"})}),s.status==="Closed"&&e.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(i,{color:"red"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[s.priority==="High"&&e.jsx("div",{className:"bg-red-100 p-1.5 rounded-full w-7 h-7",children:e.jsx(i,{color:"red"})}),s.priority==="Medium"&&e.jsx("div",{className:"bg-yellow-100 p-1.5 rounded-full w-7 h-7",children:e.jsx(i,{color:"yellow"})}),s.priority==="Low"&&e.jsx("div",{className:"bg-green-100 p-1.5 rounded-full w-7 h-7",children:e.jsx(i,{color:"green"})}),e.jsx("h3",{className:"font-bold",children:s.subject})]}),e.jsxs("div",{className:"flex flex-col ml-8",children:[e.jsx("p",{children:s.assigned_to}),e.jsxs("p",{className:"text-center w-fit text-sm flex items-center gap-1 mt-2",children:[e.jsx(W,{}),(()=>{const n=new Date(s.creation).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),l=s.creation.split(" ")[1].split(".")[0];return`${n} ${l}`})()]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[e.jsx("p",{className:`rounded-2xl text-center py-1 px-4 w-fit text-sm 
                      ${s.ticket_status==="Open"?"bg-blue-200 text-red-600":s.ticket_status==="Working Tickets"?"bg-pink-100 text-green-600":s.ticket_status==="Solved Tickets "?"bg-green-100 text-green-600":s.ticket_status==="Sent Tickets"?"bg-purple-100 text-purple-600":s.ticket_status==="Unassigned Tickets"?"bg-orange-100 text-orange-600":s.ticket_status==="Overdue Tickets"?"bg-red-100 text-red-600":s.ticket_status==="Closed Tickets"?"bg-purple-100 text-gray-600":s.ticket_status==="On-Hold Tickets"?"bg-gray-100 text-gray-600":s.ticket_status==="Needs Verification"?"bg-purple-100 text-purple-600":"bg-pink-100 text-pink-600"}`,children:s.ticket_status.split("Tickets")[0]}),e.jsxs("div",{className:"text-center w-fit text-sm flex items-center gap-1",children:[e.jsx(z,{}),e.jsxs("p",{className:"text-sm",children:["Due: ",new Date(s.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})," "]})]})]})]},s.name)):e.jsx("p",{className:"text-gray-500",children:"No tickets found"})})]})]})};export{de as default};
