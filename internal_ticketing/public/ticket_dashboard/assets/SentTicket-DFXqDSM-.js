import{f as L,r as s,E as l,b as D,j as t,L as E}from"./index-Q6dyHrre.js";import{S as O,c as a,b as p,B as U}from"./index-zoz3kVfw.js";import{a as i,g as A}from"./index-Bkeb3vF4.js";import{l as B}from"./index-CF4wHI2V.js";const K=()=>{const{getUserCookie:h}=L(),[M,j]=s.useState([]),[$,_]=s.useState([]),[o,f]=s.useState(""),[F,P]=s.useState(!1),[u,Q]=s.useState("All Tickets"),{call:b}=l("internal_ticketing.ticketing_api.get_ticket_count_by_department"),{call:y}=l("internal_ticketing.ticketing_api.get_ticket_list"),[H,I]=s.useState("All Tickets"),[d,k]=s.useState(""),[g,v]=s.useState(""),[W,R]=s.useState([]),{ticketId:V}=D();i.set(h);const[m,N]=s.useState([]),x=B("http://10.80.4.63:9001"),{call:w}=l("internal_ticketing.ticketing_api.get_user_department");x.on("ticket_updated",e=>{console.log("ðŸ”„ Ticket update received from Node:",e)}),x.on("new_ticket",e=>{console.log("ðŸ”„ New ticket received from Node:",e)}),s.useEffect(()=>{w({user_id:i.get("user_id")}).then(e=>{k(e.message[0].department),v(e.message[0].user_permission_type),S(d,g,i.get("user_id")),T(d,g,i.get("user_id"))}).catch(e=>{console.log("Error",e)})},[d]);const S=(e,c,n)=>{b({department:e,user_permission_type:c,user_id:n}).then(r=>{j(Object.values(r.message))}).catch(r=>{console.log("Error",r)})},T=(e,c,n)=>{y({department:e,user_permission_type:c,user_id:n}).then(r=>{_(r.message)}).catch(r=>{console.log("Error",r)})},{call:C}=l("internal_ticketing.ticketing_api.get_ticket_created_by_user");return s.useEffect(()=>{C({user_id:i.get("user_id")}).then(e=>{N(e)})},[]),t.jsxs("div",{className:"w-full",children:[t.jsx("div",{className:"w-full flex",children:t.jsx("div",{className:"w-1/2",children:t.jsx(O,{searchQuery:o,onSearchQueryChange:f})})}),t.jsxs("div",{className:"p-4 shadow-2xl rounded-lg bg-white mt-3",children:[t.jsx("div",{className:"flex justify-between items-center px-4 my-2",children:t.jsx("h2",{className:"text-xl font-bold",children:(m.message,"Sent Tickets")})}),t.jsx("hr",{className:"border-gray-200 mt-4"}),t.jsx("div",{className:"p-2 rounded-lg bg-white cursor-pointer overflow-y-auto max-h-[600px] scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 flex flex-col gap-1 mt-2",children:m.message?m.message.map(e=>(u==="All Tickets"||e.ticket_status===u)&&(o===""||e.subject.toLowerCase().includes(o.toLowerCase()))&&t.jsxs(E,{to:`/dashboard/tickets/${e.name}`,className:"border-2 border-gray-200 p-4 mb-2 rounded hover:bg-[rgb(177,216,216)] flex justify-between items-start rounded-2xl",children:[t.jsxs("div",{className:"flex ",children:[e.status==="Open"&&t.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(a,{color:"red"})}),e.status==="Working"&&t.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(p,{color:"green"})}),e.status==="Solved"&&t.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(p,{color:"green"})}),e.status==="Sent"&&t.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(a,{color:"green"})}),e.status==="Unassigned"&&t.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(a,{color:"green"})}),e.status==="Overdue"&&t.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(a,{color:"red"})}),e.status==="Closed"&&t.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:t.jsx(a,{color:"red"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-1",children:[e.priority==="High"&&t.jsx("div",{className:"bg-red-100 p-1.5 rounded-full w-7 h-7",children:t.jsx(a,{color:"red"})}),e.priority==="Medium"&&t.jsx("div",{className:"bg-yellow-100 p-1.5 rounded-full w-7 h-7",children:t.jsx(a,{color:"yellow"})}),e.priority==="Low"&&t.jsx("div",{className:"bg-green-100 p-1.5 rounded-full w-7 h-7",children:t.jsx(a,{color:"green"})}),t.jsx("h3",{className:"font-bold",children:e.subject})]}),t.jsxs("div",{className:"flex flex-col ml-8",children:[t.jsx("p",{children:e.assigned_to}),t.jsxs("p",{className:"text-center w-fit text-sm flex items-center gap-1 mt-2",children:[t.jsx(U,{}),(()=>{const n=new Date(e.creation).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),r=e.creation.split(" ")[1].split(".")[0];return`${n} ${r}`})()]})]})]})]}),t.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[t.jsx("p",{className:`rounded-2xl text-center py-1 px-4 w-fit text-sm 
                      ${e.ticket_status==="Open"?"bg-blue-200 text-red-600":e.ticket_status==="Working Tickets"?"bg-pink-100 text-green-600":e.ticket_status==="Solved Tickets "?"bg-green-100 text-green-600":e.ticket_status==="Sent Tickets"?"bg-purple-100 text-purple-600":e.ticket_status==="Unassigned Tickets"?"bg-orange-100 text-orange-600":e.ticket_status==="Overdue Tickets"?"bg-red-100 text-red-600":e.ticket_status==="Closed Tickets"?"bg-purple-100 text-gray-600":e.ticket_status==="On-Hold Tickets"?"bg-gray-100 text-gray-600":e.ticket_status==="Needs Verification"?"bg-purple-100 text-purple-600":"bg-pink-100 text-pink-600"}`,children:e.ticket_status.split("Tickets")[0]}),t.jsxs("div",{className:"text-center w-fit text-sm flex items-center gap-1",children:[t.jsx(A,{}),t.jsxs("p",{className:"text-sm",children:["Due: ",new Date(e.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})," "]})]})]})]},e.name)):t.jsx("p",{className:"text-gray-500",children:"No tickets found"})})]})]})};export{K as default};
