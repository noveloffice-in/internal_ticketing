import{j as e,f as P,r,E as j,b as W,L as $}from"./index-kZWgRziL.js";import{c as Q,d as H,G as x,a as i}from"./js.cookie-DJbBQs1m.js";import{a as G,b as R}from"./index-C2tcYtx8.js";import{B as V,a as q,l as J,C as K,b as X}from"./index-Dcgnjlaj.js";const Y=({searchQuery:t,onSearchQueryChange:o})=>e.jsx("div",{className:"bg-white shadow-md flex flex-col items-start p-4 rounded-xl",children:e.jsxs("div",{className:"flex items-center w-full",children:[e.jsx(Q,{className:"text-gray-600 mr-2"}),e.jsx("input",{className:"text-xl text-gray-700 focus:outline-none w-full",type:"text",placeholder:"Search Tickets...",value:t,onChange:m=>o(m.target.value)})]})}),Z=({text:t,onClick:o})=>e.jsxs("button",{onClick:o,className:"bg-[rgb(24,161,161)] text-white rounded-xl flex items-center px-10  text-xl py-3",children:[e.jsx(H,{className:"mr-3"}),t]});function f(t){return x({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"},child:[]}]})(t)}function n(t){return x({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24l0 112c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-112c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"},child:[]}]})(t)}function I(t){return x({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 128C0 92.7 28.7 64 64 64l448 0c35.3 0 64 28.7 64 64l0 64c0 8.8-7.4 15.7-15.7 18.6C541.5 217.1 528 235 528 256s13.5 38.9 32.3 45.4c8.3 2.9 15.7 9.8 15.7 18.6l0 64c0 35.3-28.7 64-64 64L64 448c-35.3 0-64-28.7-64-64l0-64c0-8.8 7.4-15.7 15.7-18.6C34.5 294.9 48 277 48 256s-13.5-38.9-32.3-45.4C7.4 207.7 0 200.8 0 192l0-64z"},child:[]}]})(t)}function ee(t){return x({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M64 64C28.7 64 0 92.7 0 128l0 64c0 8.8 7.4 15.7 15.7 18.6C34.5 217.1 48 235 48 256s-13.5 38.9-32.3 45.4C7.4 304.3 0 311.2 0 320l0 64c0 35.3 28.7 64 64 64l448 0c35.3 0 64-28.7 64-64l0-64c0-8.8-7.4-15.7-15.7-18.6C541.5 294.9 528 277 528 256s13.5-38.9 32.3-45.4c8.3-2.9 15.7-9.8 15.7-18.6l0-64c0-35.3-28.7-64-64-64L64 64zm64 112l0 160c0 8.8 7.2 16 16 16l288 0c8.8 0 16-7.2 16-16l0-160c0-8.8-7.2-16-16-16l-288 0c-8.8 0-16 7.2-16 16zM96 160c0-17.7 14.3-32 32-32l320 0c17.7 0 32 14.3 32 32l0 192c0 17.7-14.3 32-32 32l-320 0c-17.7 0-32-14.3-32-32l0-192z"},child:[]}]})(t)}const se=({ticketInfo:t,onClick:o,activeCard:m})=>{const h=m===t.ticket_status;return e.jsxs("div",{className:`shadow-md rounded-xl p-4 w-[195px] h-[100px] mt-4 cursor-pointer hover:bg-[rgb(142,189,189)] ${h?"bg-[rgb(177,216,216)]":"bg-white"}`,onClick:()=>o(t.ticket_status),children:[e.jsx("div",{className:"flex items-center justify-between text-gray-600",children:t.ticket_status}),e.jsxs("div",{className:"flex felx-col items-center justify-between text-2xl font-bold mt-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:t.count}),e.jsxs("div",{className:"flex items-center justify-between",children:[t.ticket_status==="All Tickets"&&e.jsx("div",{className:"bg-purple-200 p-2 rounded-full",children:e.jsx(G,{color:"purple"})}),t.ticket_status==="Open Tickets"&&e.jsx("div",{className:"bg-blue-200 p-2 rounded-full",children:e.jsx(I,{color:"blue"})}),t.ticket_status==="Working Tickets"&&e.jsx("div",{className:"bg-pink-100 p-2 rounded-full",children:e.jsx(ee,{color:"pink"})}),t.ticket_status==="Solved Tickets"&&e.jsx("div",{className:"bg-green-100 p-2 rounded-full",children:e.jsx(f,{color:"green"})}),t.ticket_status==="Unassigned Tickets"&&e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(R,{color:"orange"})}),t.ticket_status==="Overdue Tickets"&&e.jsx("div",{className:"bg-red-100 p-2 rounded-full",children:e.jsx(n,{color:"red"})}),t.ticket_status==="On-Hold Tickets"&&e.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:e.jsx(V,{color:"gray"})}),t.ticket_status==="Needs Verification"&&e.jsx("div",{className:"bg-purple-100 p-2 rounded-full",children:e.jsx(q,{color:"purple"})})]})]})]})};function te(t){return x({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"},child:[]},{tag:"path",attr:{d:"M13 7h-2v5.414l3.293 3.293 1.414-1.414L13 11.586z"},child:[]}]})(t)}const de=()=>{const{getUserCookie:t}=P(),[o,m]=r.useState(0),[h,y]=r.useState([]),[b,C]=r.useState([]),[p,T]=r.useState(""),[v,_]=r.useState(!1),[g,S]=r.useState("All Tickets"),{call:L}=j("internal_ticketing.ticketing_api.get_ticket_count_by_department"),{call:M}=j("internal_ticketing.ticketing_api.get_ticket_list"),D=["Cancelled Tickets"],[U,k]=r.useState("All Tickets"),[d,z]=r.useState(""),[u,B]=r.useState(""),[re,le]=r.useState([]),{ticketId:ce}=W();i.set(t);const{call:O}=j("internal_ticketing.ticketing_api.get_user_department");r.useEffect(()=>{const s=J("ws://10.80.4.63:9000",{transports:["websocket"]});return s.on("connect",()=>{console.log("✅ Connected to WebSocket!")}),s.on("internal_ticket_update",c=>{console.log("📩 New Ticket Update:",c),setTickets(l=>[...l,c])}),s.on("disconnect",()=>{console.log("❌ WebSocket Disconnected")}),()=>{s.disconnect()}},[]),r.useEffect(()=>{O({user_id:i.get("user_id")}).then(s=>{z(s.message[0].department),B(s.message[0].user_permission_type),console.log("User Permission Type",u),console.log("User Department",d),console.log("User ID",i.get("user_id")),w(d,u,i.get("user_id")),N(d,u,i.get("user_id"))}).catch(s=>{console.log("Error",s)})},[d]);const E=()=>{_(!0)},F=()=>{_(!1),w(d,u,i.get("user_id")),N(d,u,i.get("user_id"))},w=(s,c,l)=>{L({department:s,user_permission_type:c,user_id:l}).then(a=>{y(Object.values(a.message))}).catch(a=>{console.log("Error",a)})},N=(s,c,l)=>{M({department:s,user_permission_type:c,user_id:l}).then(a=>{C(a.message)}).catch(a=>{console.log("Error",a)})},A=s=>{S(s),k(s)};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full flex",children:[e.jsx("div",{className:"w-1/2",children:e.jsx(Y,{searchQuery:p,onSearchQueryChange:T})}),e.jsxs("div",{className:"w-1/2 flex justify-end",children:[e.jsx(Z,{text:"Create Ticket",onClick:E}),v&&e.jsx(K,{onClick:F,isOpen:v,isSubticket:!1})]})]}),e.jsx("div",{className:"flex gap-4 flex flex-row w-full flex-wrap",children:h.map((s,c)=>!D.includes(s.ticket_status)&&e.jsx("div",{children:e.jsx(se,{ticketInfo:s,activeCard:U,onClick:l=>{A(l),k(l)}})},c))}),e.jsxs("div",{className:"p-4 shadow-2xl rounded-lg bg-white mt-3",children:[e.jsx("div",{className:"flex justify-between items-center px-4 my-2",children:e.jsx("h2",{className:"text-xl font-bold",children:g||"All Tickets List"})}),e.jsx("hr",{className:"border-gray-200 mt-4"}),e.jsx("div",{className:"p-2 rounded-lg bg-white cursor-pointer overflow-y-auto max-h-[600px] scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-100 flex flex-col gap-1 mt-2",children:b.length>0?b.map(s=>(g==="All Tickets"||s.ticket_status===g)&&(p===""||s.subject.toLowerCase().includes(p.toLowerCase()))&&e.jsxs($,{to:`/dashboard/tickets/${s.name}`,className:"border-2 border-gray-200 p-4 mb-2 rounded hover:bg-[rgb(177,216,216)] flex justify-between items-start rounded-2xl",children:[e.jsxs("div",{className:"flex ",children:[s.status==="Open"&&e.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(n,{color:"red"})}),s.status==="Working"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(f,{color:"green"})}),s.status==="Solved"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(f,{color:"green"})}),s.status==="Sent"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(n,{color:"green"})}),s.status==="Unassigned"&&e.jsx("div",{className:"bg-green-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(n,{color:"green"})}),s.status==="Overdue"&&e.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(n,{color:"red"})}),s.status==="Closed"&&e.jsx("div",{className:"bg-red-100  flex items-center justify-center rounded-md w-7 h-7 mr-4 mt-1",children:e.jsx(n,{color:"red"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[s.priority==="High"&&e.jsx("div",{className:"bg-red-100 p-1.5 rounded-full w-7 h-7",children:e.jsx(n,{color:"red"})}),s.priority==="Medium"&&e.jsx("div",{className:"bg-yellow-100 p-1.5 rounded-full w-7 h-7",children:e.jsx(n,{color:"yellow"})}),s.priority==="Low"&&e.jsx("div",{className:"bg-green-100 p-1.5 rounded-full w-7 h-7",children:e.jsx(n,{color:"green"})}),e.jsx("h3",{className:"font-bold",children:s.subject})]}),e.jsxs("div",{className:"flex flex-col ml-8",children:[e.jsx("p",{children:s.assigned_to}),e.jsxs("p",{className:"text-center w-fit text-sm flex items-center gap-1 mt-2",children:[e.jsx(te,{}),(()=>{const l=new Date(s.creation).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),a=s.creation.split(" ")[1].split(".")[0];return`${l} ${a}`})()]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[e.jsx("p",{className:`rounded-2xl text-center py-1 px-4 w-fit text-sm ${s.ticket_status==="Open"?"bg-red-100 text-red-600":s.ticket_status==="Working Tickets"||s.ticket_status==="Solved Tickets "?"bg-green-100 text-green-600":s.ticket_status==="Sent Tickets"?"bg-purple-100 text-purple-600":s.ticket_status==="Unassigned Tickets"?"bg-orange-100 text-orange-600":s.ticket_status==="Overdue Tickets"?"bg-red-100 text-red-600":s.ticket_status==="Closed Tickets"?"bg-gray-100 text-gray-600":"bg-pink-100 text-pink-600"}`,children:s.ticket_status.split(" ")[0]}),e.jsxs("div",{className:"text-center w-fit text-sm flex items-center gap-1",children:[e.jsx(X,{}),e.jsxs("p",{className:"text-sm",children:["Due: ",new Date(s.due_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})," "]})]})]})]},s.name)):e.jsx("p",{className:"text-gray-500",children:"No tickets found"})})]})]})};export{de as default};
